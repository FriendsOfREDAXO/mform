/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */
/*  SHA-1 implementation in JavaScript | (c) Chris Veness 2002-2010 | www.movable-type.co.uk      */
/*   - see http://csrc.nist.gov/groups/ST/toolkit/secure_hashing.html                             */
/*         http://csrc.nist.gov/groups/ST/toolkit/examples.html                                   */
/*         http://www.movable-type.co.uk/scripts/sha1.html                                        */
/* - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -  */
var Sha1={};
Sha1.hash=function(b,a){if(a=typeof a=="undefined"?true:a)b=Utf8.encode(b);var g=[1518500249,1859775393,2400959708,3395469782];b+=String.fromCharCode(128);for(var c=Math.ceil((b.length/4+2)/16),h=Array(c),e=0;e<c;e++){h[e]=Array(16);for(var f=0;f<16;f++)h[e][f]=b.charCodeAt(e*64+f*4)<<24|b.charCodeAt(e*64+f*4+1)<<16|b.charCodeAt(e*64+f*4+2)<<8|b.charCodeAt(e*64+f*4+3)}h[c-1][14]=(b.length-1)*8/Math.pow(2,32);h[c-1][14]=Math.floor(h[c-1][14]);h[c-1][15]=(b.length-1)*8&4294967295;f=1732584193;var n=
4023233417,o=2562383102,p=271733878,q=3285377520,i=Array(80),j,k,l,m,r;for(e=0;e<c;e++){for(var d=0;d<16;d++)i[d]=h[e][d];for(d=16;d<80;d++)i[d]=Sha1.ROTL(i[d-3]^i[d-8]^i[d-14]^i[d-16],1);j=f;k=n;l=o;m=p;r=q;for(d=0;d<80;d++){var s=Math.floor(d/20);s=Sha1.ROTL(j,5)+Sha1.f(s,k,l,m)+r+g[s]+i[d]&4294967295;r=m;m=l;l=Sha1.ROTL(k,30);k=j;j=s}f=f+j&4294967295;n=n+k&4294967295;o=o+l&4294967295;p=p+m&4294967295;q=q+r&4294967295}return Sha1.toHexStr(f)+Sha1.toHexStr(n)+Sha1.toHexStr(o)+Sha1.toHexStr(p)+Sha1.toHexStr(q)};
Sha1.f=function(b,a,g,c){switch(b){case 0:return a&g^~a&c;case 1:return a^g^c;case 2:return a&g^a&c^g&c;case 3:return a^g^c}};Sha1.ROTL=function(b,a){return b<<a|b>>>32-a};Sha1.toHexStr=function(b){for(var a="",g,c=7;c>=0;c--){g=b>>>c*4&15;a+=g.toString(16)}return a};var Utf8={};
Utf8.encode=function(b){b=b.replace(/[\u0080-\u07ff]/g,function(a){a=a.charCodeAt(0);return String.fromCharCode(192|a>>6,128|a&63)});return b=b.replace(/[\u0800-\uffff]/g,function(a){a=a.charCodeAt(0);return String.fromCharCode(224|a>>12,128|a>>6&63,128|a&63)})};
Utf8.decode=function(b){b=b.replace(/[\u00e0-\u00ef][\u0080-\u00bf][\u0080-\u00bf]/g,function(a){a=(a.charCodeAt(0)&15)<<12|(a.charCodeAt(1)&63)<<6|a.charCodeAt(2)&63;return String.fromCharCode(a)});return b=b.replace(/[\u00c0-\u00df][\u0080-\u00bf]/g,function(a){a=(a.charCodeAt(0)&31)<<6|a.charCodeAt(1)&63;return String.fromCharCode(a)})};
